class e{constructor(){this.handler={ref:this,add(e){return this.ref.value=e,e}}}startObject(){this.handler={old:this.handler,key:null,ref:this.handler.add({}),add(e){return null===this.key?this.key=e:(this.ref[this.key]=e,this.key=null),e}}}endObject(){this.handler=this.handler.old}startArray(){this.handler={old:this.handler,ref:this.handler.add([]),add(e){return this.ref.push(e),e}}}add(e){this.handler.add(e)}handle(e){switch(e.type){case"{":this.startObject();break;case"}":this.endObject();break;case"[":this.startArray();break;case"]":this.endArray();break;case"string":case"number":case"true":case"false":case"null":this.add(e.value);break;case"error":throw new SyntaxError(e.value.message)}}}e.prototype.endArray=e.prototype.endObject;class t{constructor(e){this.text=e}[Symbol.iterator](){return r(this.text)}tokens(){return r(this.text)}}function*r(e){const t={s:e,d:!1,f:0,l:e.length,e:1,c:0,r:1,x:[]};for(;;){if(t.f===t.l){if(!t.e&&!t.x.length)return;yield n(t.s,t.l,t.l,"Unexpected end of JSON input")}const e=c(t);t.f=e.last,yield e}}function n(e,r,n,a,s=1){let i=r,o=e.charCodeAt(i);for(;10!==o&&i>0;)o=e.charCodeAt(--i);10===o&&++i;const c="undefined:"+s,u=e.slice(i,r+1);let l="";for(let e=i;e<r;++e)l+=" ";l+="^";const d=new SyntaxError(c+"\n"+u+"\n"+l+"\n\n"+a);return{type:t.Error,value:d,first:r,last:n}}function a(e,r,n){return{type:t.StartObject,value:"{",first:r,last:r+1}}function s(e,r,n){return{type:t.EndObject,value:"}",first:r,last:r+1}}function i(e,r,n){return{type:t.StartArray,value:"[",first:r,last:r+1}}function o(e,r,n){return{type:t.EndArray,value:"]",first:r,last:r+1}}function c(e){const{s:r,l:c}=e;let{f:d}=e;for(;d<c;)switch(e.c++,r.charCodeAt(d)){case 10:e.c=0,e.r++;case 9:case 13:case 32:++d;continue;case 123:return 1&e.e?(e.e=18,e.x.push(32),a(0,d)):n(r,d,c,"Unexpected token { in JSON at position "+d,e.r);case 125:return 16&e.e&&32===e.x.pop()?(e.e=e.x.length>0?20:0,s(0,d)):n(r,d,c,"Unexpected token } in JSON at position "+d,e.r);case 91:return 1&e.e?(e.e=17,e.x.push(64),i(0,d)):n(r,d,c,"Unexpected token [ in JSON at position "+d,e.r);case 93:return 16&e.e&&64===e.x.pop()?(e.e=e.x.length>0?20:0,o(0,d)):n(r,d,c,"Unexpected token ] in JSON at position "+d,e.r);case 58:if(!(8&e.e))return n(r,d,c,"Unexpected token : in JSON at position "+d,e.r);e.e=1,++d;continue;case 44:if(!(4&e.e))return n(r,d,c,"Unexpected token , in JSON at position "+d,e.r);e.x.length>0&&32===e.x[e.x.length-1]?e.e=2:e.e=1,++d;continue;case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return 1&e.e?(e.e=e.x.length>0?20:0,u(r,d,c)):n(r,d,c,"Unexpected number in JSON at position "+d,e.r);case 34:return 2&e.e?(e.e=8,l(r,d,c)):1&e.e?(e.e=e.x.length>0?20:0,l(r,d,c)):n(r,d,c,"Unexpected string in JSON at position "+d,e.r);case 116:return 1&e.e?(e.e=e.x.length>0?20:0,f(r,d,c)):n(r,d,c,"Unexpected token t in JSON at position "+d,e.r);case 102:return 1&e.e?(e.e=e.x.length>0?20:0,h(r,d,c)):n(r,d,c,"Unexpected token f in JSON at position "+d,e.r);case 110:return 1&e.e?(e.e=e.x.length>0?20:0,p(r,d,c)):n(r,d,c,"Unexpected token n in JSON at position "+d,e.r);default:return n(r,d,c,"Unexpected token "+r[d]+" in JSON at position "+d,e.r)}return{type:t.EndDocument,first:c,last:c}}function u(e,r,a){let s=r,i=e.charCodeAt(s++);if(45===i&&(i=e.charCodeAt(s++)),48!==i)for(;i>=48&&i<=57;)i=e.charCodeAt(s++);else i=e.charCodeAt(s++);if(46===i)for(i=e.charCodeAt(s++);i>=48&&i<=57;)i=e.charCodeAt(s++);if(101===i||69===i){if(i=e.charCodeAt(s++),43!==i&&45!==i||(i=e.charCodeAt(s++)),i<48||i>57)return n(e,s-1,a,"Unexpected token "+e[s-1]+" in JSON at position "+(s-1));if(s>=a)return n(e,r,a,"Unexpected end of JSON input");for(;i>=48&&i<=57;)i=e.charCodeAt(s++)}return{type:t.Number,value:Number.parseFloat(e.slice(r,s-1)),first:r,last:s-1}}function l(e,r,a){let s=r+1;for(;s<a;){let t=e.charCodeAt(s++);if(34===t)break;if(92===t&&(t=e.charCodeAt(s++),117===t&&(s+=4,s>a)))return n(e,a,a,"Unexpected end of JSON input")}return{type:t.String,value:JSON.parse(e.slice(r,s)),source:e,first:r,last:s}}function d(e,t,r,a,s){if(t+a.length>r)return n(e,r,r,"Unexpected end of JSON input");for(const s of a){if(e.charCodeAt(t++)!==s)return n(e,t,r,"Unexpected token "+e[t-1]+" in JSON at position "+(t-1))}return s}function f(e,r,n){return d(e,r,n,[116,114,117,101],{type:t.TrueLiteral,value:!0,source:e,first:r,last:r+4})}function h(e,r,n){return d(e,r,n,[102,97,108,115,101],{type:t.FalseLiteral,value:!1,source:e,first:r,last:r+5})}function p(e,r,n){return d(e,r,n,[110,117,108,108],{type:t.NullLiteral,value:null,source:e,first:r,last:r+4})}t.StartDocument="<",t.EndDocument=">",t.StartObject="{",t.EndObject="}",t.StartArray="[",t.EndArray="]",t.String="string",t.Number="number",t.TrueLiteral="true",t.FalseLiteral="false",t.NullLiteral="null",t.Whitespace="ws",t.Error="error",t.ObjectBuilder=e,t.parse=function(t,n){"string"!=typeof t&&(t=String(t));const a=new e;for(const e of r(t))a.handle(e);if(void 0===a.value)throw new SyntaxError("Unexpected end of JSON input");return a.value};export default t;
//# sourceMappingURL=json-pull-parser.js.map
